{% extends 'master_page_nonlogged.html' %}
{% block content %}

    <div class="alert alert-success alert-dismissable text-center" style="margin-top: 5%">Here you are! Your plan for
        today!
        <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
    </div>


    <div class="row div-card-plan-whole">

        {% if activities.count > 0  %}

        {% for activity in activities %}

            {% if forloop.counter <= 3 %}
                <div class="col-sm-6 col-md-4">
                    <button id="cross" type="button" class="close div-card-plan-quit" data-dismiss="alert"
                            aria-hidden="true">
                        <strong>&times</strong>
                    </button>

                    <div id="thumb{{ forloop.counter }}" class="thumbnail div-card-plan-thumbnail"
                         style="background-image:url('{{ MEDIA_URL }}{{ activity.photo }}')">

                        <div id="info{{ forloop.counter }}" style="display: none" class="well div-card-plan-info">
                            {{ activity.description }}
                        </div>


                    </div>


                    <div class="text-center panel div-card-plan-actiname">
                        <h4>{{ activity.name }}</h4>
                    </div>


                </div>
            {% endif %}
        {% endfor %}
    {% endif %}

    </div>


    <div id="map-canvas" class="google-map-canvas ">
    </div>
    <div class="well-lg text-center ">


        <a href="" class="btn button-orange-plan">I want this plan</a>
        <a href="#filter" class=" btn button-orange-plan" data-toggle="modal">Filter to obtain another plan</a>

    </div>

    <style type="text/css">
        html {
            height: 100%
        }

        body {
            height: 100%;
            margin: 0;
            padding: 0
        }

        #map-canvas {
            height: 30%;
            width: 60%;
            margin-left: 20%;
            margin-top: 5%;;
        }

        #map-canvas:hover {
            box-shadow: inset 0 1px 1px orange, 0 0 8px orange;
            -moz-box-shadow: inset 0 1px 1px orange, 0 0 8px orange;
            webkit-box-shadow: inset 0 1px 1px orange, 0 0 8px orange;

        }
    </style>
    <script type="text/javascript"
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDXn3jBP_WNPRZl--vp_ycQfqbX-WJFn0U&sensor=false">
    </script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js">
    </script>
    <script type="text/javascript">


        $("#thumb1").hover(function () {
            $("#info1").css("display", "block");
        }, function () {
            $("#info1").css("display", "none");
        });

        $("#thumb2").hover(function () {
            $("#info2").css("display", "block");
        }, function () {
            $("#info2").css("display", "none");
        });

        $("#thumb3").hover(function () {
            $("#info3").css("display", "block");
        }, function () {
            $("#info3").css("display", "none");
        });


        // calculate route

        var directionsDisplay;
        var directionsService = new google.maps.DirectionsService();
        var map;

        function initialize() {
            directionsDisplay = new google.maps.DirectionsRenderer();
            var seville = new google.maps.LatLng(37.392012, -5.983726);
            var mapOptions = {
                zoom: 7,
                center: seville
            }
            map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions);
            directionsDisplay.setMap(map);
            calcRoute('{{ac1.latitude}}', '{{ac1.longitude}}', '{{ac2.latitude}}', '{{ac2.longitude}}', '{{ac3.latitude}}', '{{ac3.longitude}}')

        }

        function calcRoute(lat1, lon1, lat2, lon2, lat3, lon3) {
            //var start = new google.maps.LatLng(37.334481,-5.931160);
            //var end = new google.maps.LatLng(37.338678, -5.935896);

            // parsing variables to fix semicolon problem
            var lat1r = lat1.replace(",", ".");
            var lon1r = lon1.replace(",", ".");
            var lat2r = lat2.replace(",", ".");
            var lon2r = lon2.replace(",", ".");
            var lat3r = lat3.replace(",", ".");
            var lon3r = lon3.replace(",", ".");

            // end parsing

            var start = new google.maps.LatLng(lat1r, lon1r);
            var wp1 = new google.maps.LatLng(lat2r, lon2r);
            var end = new google.maps.LatLng(lat3r, lon3r);
            var wps = [
                {location: wp1}
            ];
            var request = {
                origin: start,
                destination: end,
                waypoints: wps,
                travelMode: google.maps.TravelMode.DRIVING
            };

            directionsService.route(request, function (result, status) {
                if (status == google.maps.DirectionsStatus.OK) {
                    directionsDisplay.setDirections(result);
                }
            });
        }

        google.maps.event.addDomListener(window, 'load', initialize);


        //
        {{forloop.counter}}
    </script>

    <div class="modal fade" id="filter" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4>Â¿Donde quieres ir?</h4>
                </div>
                <div class="modal-body">
                    <form class="form-horizontal" style="box-shadow: #999999" action="../filteresult" method="get">
                    <div class="dropdown">Location
                        <select name="l" class="form-control" id="focus">
                            <option>Sevilla</option>
                            <option>Madrid</option>
                        </select>
                        </div>
                   <label>
                       <input type="submit" class="btn button-orange-plan" value="Obtener planes">

                        </label>
                        </fieldset>
                    </form>
                </div>
            </div>
        </div>
    </div>


    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
{% endblock %}



